{"version":3,"file":"esri-search.js","sources":["node_modules/domose/domose.js","node_modules/esri-global-shared/shared.js","dependent-js/search.js"],"sourcesContent":["/* Speculative DOM Functionality\n/* ========================================================================== */\n\nfunction __assignSource(element, source, prefix) {\n\tfor (let key in source) {\n\t\tif ('function' === typeof source[key]) {\n\t\t\t// add functions as event listeners\n\t\t\telement.addEventListener(prefix + key, source[key]);\n\t\t} else if (Object(source[key]) === source[key]) {\n\t\t\t// assign objects as source\n\t\t\t__assignSource(element, source[key], `${prefix + key}-`);\n\t\t} else {\n\t\t\t// otherwise, set attributes\n\t\t\telement.setAttribute(prefix + key, source[key]);\n\t\t}\n\t}\n}\n\n/* Assign an element with attributes, events, and children\n/* ========================================================================== */\n\nfunction $assign(id) {\n\t// $assign(element, { class: 'btn', click: () => { /* listener */ } });\n\t// $assign('button', { aria: { label: 'title' } }, child);\n\t// $assign('div', child1, child2, 'a new text node');\n\t// $assign(document.createElementNS('http://www.w3.org/2000/svg', 'svg'));\n\n\tconst element = id instanceof Node ? id : document.createElement(id);\n\n\t[].slice.call(arguments, 1).forEach((source) => {\n\t\tif (source instanceof Node) {\n\t\t\t// append sources that are nodes\n\t\t\telement.appendChild(source);\n\t\t} else if ('string' === typeof source) {\n\t\t\t// append strings as text nodes\n\t\t\telement.appendChild(\n\t\t\t\tdocument.createTextNode(source)\n\t\t\t);\n\t\t} else {\n\t\t\t__assignSource(element, source, '');\n\t\t}\n\t});\n\n\treturn element;\n}\n\n/* Replace all the children of a parent node with new children\n/* ========================================================================== */\n\nfunction $replaceAll(parentNode) {\n\t// $replaceAll(element);\n\t// $replaceAll(element, child1, child2);\n\n\twhile (parentNode.lastChild) {\n\t\tparentNode.removeChild(parentNode.lastChild);\n\t}\n\n\tparentNode.appendChild(\n\t\t__asFragment(arguments)\n\t);\n\n\treturn parentNode;\n}\n\n/* Wrap a child node within an element\n/* ========================================================================== */\n\nfunction $wrapWith(childNode, element) {\n\t// $wrapWith(element, wrappingElement);\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.insertBefore(element, childNode).appendChild(childNode);\n\t}\n\n\treturn childNode;\n}\n\n/* Emerging DOM Functionality\n/* ========================================================================== */\n\nfunction __asFragment(nodes) {\n\tconst fragment = document.createDocumentFragment();\n\n\t[].slice.call(nodes, 1).forEach((node) => {\n\t\tif (node instanceof Node) {\n\t\t\tfragment.appendChild(node);\n\t\t} else {\n\t\t\tfragment.appendChild(\n\t\t\t\tdocument.createTextNode(node)\n\t\t\t);\n\t\t}\n\t});\n\n\treturn fragment;\n}\n\n/* Insert nodes after a child node\n/* ========================================================================== */\n\nfunction $after(childNode) {\n\t// $after(element, sibling1, sibling2, 'a new text node');\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.insertBefore(\n\t\t\t__asFragment(arguments),\n\t\t\tchildNode.nextSibling\n\t\t);\n\t}\n\n\treturn childNode;\n}\n\n/* Appends nodes to a parent node\n/* ========================================================================== */\n\nfunction $append(parentNode) {\n\t// $append(parentNode, child1, child2, 'a new text node');\n\n\tparentNode.append(\n\t\t__asFragment(arguments)\n\t);\n\n\treturn parentNode;\n}\n\n/* Insert nodes before an element\n/* ========================================================================== */\n\nfunction $before(element) {\n\t// $before(element, sibling1, sibling2, 'a new text node');\n\n\tif (element.parentNode) {\n\t\telement.parentNode.insertBefore(\n\t\t\t__asFragment(arguments),\n\t\t\telement\n\t\t);\n\t}\n\n\treturn element;\n}\n\n/* Return the closest ancestor element matching a given selector\n/* ========================================================================== */\n\nfunction $closest(element, selectors) {\n\t// $closest(element, selectors);\n\n\tlet target = element;\n\n\twhile (target && 1 === target.nodeType) {\n\t\tif ($matches(target, selectors)) {\n\t\t\treturn target;\n\t\t}\n\n\t\ttarget = target.parentNode;\n\t}\n\n\treturn null;\n}\n\n/* Return whether or not a DOM element matches a given selector\n/* ========================================================================== */\n\nfunction $matches(element, selectors) {\n\t// $matches(element, selectors);\n\n\tconst elements = element.parentNode.querySelectorAll(selectors);\n\n\tlet index = 0;\n\n\twhile (elements[index] && elements[index] !== element) {\n\t\t++index;\n\t}\n\n\treturn Boolean(elements[index]);\n}\n\n/* Prepends a child to a parent node\n/* ========================================================================== */\n\nfunction $prepend(parentNode) {\n\t// $prepend(element, child1, child2, 'a new text node');\n\n\tparentNode.insertBefore(\n\t\t__asFragment(arguments),\n\t\tparentNode.firstChild\n\t);\n\n\treturn parentNode;\n}\n\n/* Remove a child node from its parent\n/* ========================================================================== */\n\nfunction $remove(childNode) {\n\t// $remove(element);\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.removeChild(childNode);\n\t}\n\n\treturn childNode;\n}\n\n/* Replace a child node with nodes\n/* ========================================================================== */\n\nfunction $replaceWith(childNode) {\n\t// $replaceWith(element, sibling1, sibling2, 'a new text node');\n\n\tif (childNode.parentNode) {\n\t\tchildNode.parentNode.replaceChild(\n\t\t\t__asFragment(arguments),\n\t\t\tchildNode\n\t\t);\n\t}\n\n\treturn childNode;\n}\n\n/* Emerging Event Functionality\n/* ========================================================================== */\n\n/* Create a new CustomEvent\n/* ========================================================================== */\n\nfunction $CustomEvent(type) {\n\t// element.dispatchEvent(new $CustomEvent('click', { bubbles: true }));\n\n\tconst event = document.createEvent('CustomEvent');\n\tconst param = Object(arguments[1]) || { bubbles: false, cancelable: false, detail: undefined };\n\n\tevent.initCustomEvent(type, param.bubbles, param.cancelable, param.detail);\n\n\treturn event;\n}\n\n/* Fetch response text from a URL and pass it to a callback\n/* ========================================================================== */\n\nfunction $fetch(url, callback) {\n\t// $fetch('api?foo=bar', (responseText) => {});\n\n\tconst xhr = new XMLHttpRequest();\n\n\txhr.addEventListener('readystatechange', () => {\n\t\tif (4 === xhr.readyState && 200 === xhr.status) {\n\t\t\tcallback(xhr.responseText); // eslint-disable-line callback-return\n\t\t}\n\t});\n\n\txhr.open('GET', url);\n\txhr.send();\n\n\treturn xhr;\n}\n\n/* Export\n/* ========================================================================== */\n\nexport {\n\t$assign,\n\t$after,\n\t$append,\n\t$before,\n\t$closest,\n\t$CustomEvent,\n\t$fetch,\n\t$matches,\n\t$prepend,\n\t$remove,\n\t$replaceAll,\n\t$replaceWith,\n\t$wrapWith\n};\n","import { $assign, $fetch, $replaceAll } from 'domose';\n\n/* Dispatch an Custom Event with a detail\n/* ========================================================================== */\n\nfunction $dispatch(target, type, detail) {\n\t// an event\n\tconst event = document.createEvent('CustomEvent');\n\n\tevent.initCustomEvent(type, true, true, detail);\n\n\ttarget.dispatchEvent(event);\n}\n\nfunction $enableFocusRing(target) {\n\t// retooled from https://github.com/jonathantneal/js-focus-ring\n\n\tlet keyboardThrottleTimeoutID;\n\n\tconst activeElements = [];\n\n\ttarget.addEventListener('blur', () => {\n\t\tactiveElements.forEach((activeElement) => {\n\t\t\tactiveElement.removeAttribute('js-focus');\n\t\t\tactiveElement.removeAttribute('js-focus-ring');\n\t\t});\n\t}, true);\n\n\ttarget.addEventListener('focus', () => {\n\t\tconst activeElement = document.activeElement;\n\n\t\tif (activeElement instanceof Element) {\n\t\t\tactiveElement.setAttribute('js-focus', '');\n\n\t\t\tif (keyboardThrottleTimeoutID) {\n\t\t\t\tactiveElement.setAttribute('js-focus-ring', '');\n\t\t\t}\n\n\t\t\tactiveElements.push(activeElement);\n\t\t}\n\t}, true);\n\n\ttarget.addEventListener('keydown', () => {\n\t\tkeyboardThrottleTimeoutID = clearTimeout(keyboardThrottleTimeoutID) || setTimeout(() => {\n\t\t\tkeyboardThrottleTimeoutID = 0;\n\t\t}, 100);\n\t}, true);\n}\n\nexport {\n\t$assign,\n\t$dispatch,\n\t$enableFocusRing,\n\t$fetch,\n\t$replaceAll\n};\n","import { $assign as $, $dispatch } from 'esri-global-shared';\n\n/* Search\n/* ========================================================================== */\n\nexport default (data) => {\n\t/* Elements\n\t/* ====================================================================== */\n\n\tconst $label = $('label', {\n\t\tclass: `${data.prefix}-label`,\n\t\tfor: `${data.prefix}-query-control`\n\t}, data.queryLabel);\n\n\tconst $control = $('input', {\n\t\tclass: `${data.prefix}-control`, id: `${data.prefix}-control`,\n\t\ttype: 'search', name: 'q',\n\t\tautocapitalize: 'off', autocomplete: 'off', autocorrect: 'off', spellcheck: 'false'\n\t});\n\n\tconst $measureTextNode = document.createTextNode('');\n\n\tconst $measureText = $('div', {\n\t\tclass: `${data.prefix}-measure-text`,\n\t\taria: { hidden: true }\n\t}, $measureTextNode);\n\n\tconst $measure = $('div', { class: `${data.prefix}-measure` }, $measureText);\n\n\tconst $submit = $('button', {\n\t\tclass: `${data.prefix}-submit`, type: 'submit',\n\t\taria: { label: data.submitLabel }\n\t});\n\n\tconst $search = $('form', {\n\t\tclass: `${data.prefix}-form`, action: data.action,\n\t\trole: 'search', aria: { label: data.label }\n\t}, $label, $control, $measure, $submit);\n\n\t/* Focus Event\n\t/* ====================================================================== */\n\n\t$search.addEventListener(`${data.prefix}:focus`, () => {\n\t\t$control.focus();\n\t});\n\n\t/* On Input\n\t/* ====================================================================== */\n\n\tlet controlIsFilled = false;\n\tlet controlValue = '';\n\n\tfunction oninput(event) {\n\t\t/* Conditionally Reset Control Value\n\t\t/* ================================================================== */\n\n\t\tif (event && 'reset' === event.type) {\n\t\t\t$control.value = '';\n\t\t}\n\n\t\t/* Update New Control Value\n\t\t/* ================================================================== */\n\n\t\tconst newControlValue = $control.value;\n\n\t\tif (newControlValue !== controlValue) {\n\t\t\tcontrolValue = newControlValue;\n\n\t\t\t$dispatch($search, `${data.prefix}:input`, {\n\t\t\t\tvalue: controlValue,\n\t\t\t\tevent\n\t\t\t});\n\t\t}\n\n\t\t/* Update Label and Submit UI\n\t\t/* ================================================================== */\n\n\t\tif (controlIsFilled && !newControlValue) {\n\t\t\tcontrolIsFilled = false;\n\n\t\t\t$label.removeAttribute('data-filled');\n\t\t\t$submit.removeAttribute('data-filled');\n\t\t} else if (!controlIsFilled && newControlValue) {\n\t\t\tcontrolIsFilled = true;\n\n\t\t\t$($label, { data: { filled: '' } });\n\t\t\t$($submit, { data: { filled: '' } });\n\t\t}\n\n\t\t/* Update Measure UI\n\t\t/* ================================================================== */\n\n\t\t$measureTextNode.nodeValue = newControlValue;\n\n\t\tconst currentWidth = `${$measureText.scrollWidth}px`;\n\n\t\t$measure.style.width = currentWidth;\n\t}\n\n\t/* On Submit\n\t/* ====================================================================== */\n\n\tfunction onsubmit(event) {\n\t\t$dispatch($search, `${data.prefix}:submit`, {\n\t\t\tvalue: $control.value,\n\t\t\tevent\n\t\t});\n\t}\n\n\t/* On DOMNodeInserted\n\t/* ====================================================================== */\n\n\t$search.addEventListener('DOMNodeInserted', function onDOMNodeInserted() {\n\t\t// If Search now has a parent node\n\t\tif ($search.parentNode) {\n\t\t\t// Unbind the DOMNodeInserted method\n\t\t\t$search.removeEventListener('DOMNodeInserted', onDOMNodeInserted);\n\n\t\t\t// Update Search\n\t\t\t$dispatch($search, `${data.prefix}:update`, data);\n\t\t}\n\t});\n\n\t/* On Update\n\t/* ====================================================================== */\n\n\t$search.addEventListener(`${data.prefix}:update`, () => {\n\t\t/* Bind Media Event\n\t\t/* ====================================================================== */\n\n\t\tconst media = $search.ownerDocument.defaultView.matchMedia(data.matchMedia || '(max-width: 720px)');\n\n\t\tmedia.addListener(oninput);\n\n\t\t/* Bind Other Events\n\t\t/* ================================================================== */\n\n\t\t$control.addEventListener('input', oninput);\n\n\t\t$search.addEventListener('reset', oninput);\n\t\t$search.addEventListener('submit', onsubmit);\n\t\t$search.addEventListener(`${data.prefix}:unload`, onunload);\n\t});\n\n\treturn $search;\n};\n"],"names":["__assignSource","element","source","prefix","key","addEventListener","Object","setAttribute","$assign","id","Node","document","createElement","slice","call","arguments","forEach","appendChild","createTextNode","$dispatch","target","type","detail","event","createEvent","initCustomEvent","dispatchEvent","data","oninput","value","newControlValue","$control","controlValue","$search","controlIsFilled","removeAttribute","$label","filled","$submit","nodeValue","currentWidth","$measureText","scrollWidth","style","width","onsubmit","$","queryLabel","name","autocomplete","autocorrect","spellcheck","$measureTextNode","hidden","$measure","class","label","submitLabel","action","aria","focus","onDOMNodeInserted","parentNode","removeEventListener","ownerDocument","defaultView","matchMedia","addListener","onunload"],"mappings":"uCAGA,SAASA,EAAeC,EAASC,EAAQC,OACnC,IAAIC,KAAOF,EACX,mBAAsBA,EAAOE,KAExBC,iBAAiBF,EAASC,EAAKF,EAAOE,IACpCE,OAAOJ,EAAOE,MAAUF,EAAOE,KAE1BH,EAASC,EAAOE,GAASD,EAASC,SAGzCG,aAAaJ,EAASC,EAAKF,EAAOE,IAQ7C,SAASI,EAAQC,OAMVR,EAAUQ,aAAcC,KAAOD,EAAKE,SAASC,cAAcH,YAE9DI,MAAMC,KAAKC,UAAW,GAAGC,QAAQ,SAACd,GAChCA,aAAkBQ,OAEbO,YAAYf,GACV,iBAAoBA,IAEtBe,YACPN,SAASO,eAAehB,MAGVD,EAASC,EAAQ,MAI3BD,ECtCR,SAASkB,EAAUC,EAAQC,EAAMC,OAE1BC,EAAQZ,SAASa,YAAY,iBAE7BC,gBAAgBJ,GAAM,GAAM,EAAMC,KAEjCI,cAAcH,mBCNNI,YA+CNC,EAAQL,GAIZA,GAAS,UAAYA,EAAMF,SACrBQ,MAAQ,QAMZC,EAAkBC,EAASF,MAE7BC,IAAoBE,MACRF,IAELG,EAAYN,EAAKxB,uBACnB6B,aAQLE,IAAoBJ,MACL,IAEXK,gBAAgB,iBACfA,gBAAgB,iBACbD,GAAmBJ,OACZ,IAEhBM,GAAUT,MAAQU,OAAQ,QAC1BC,GAAWX,MAAQU,OAAQ,SAMbE,UAAYT,MAEvBU,EAAkBC,EAAaC,mBAE5BC,MAAMC,MAAQJ,WAMfK,EAAStB,KACPU,EAAYN,EAAKxB,wBACnB4B,EAASF,oBA/FZO,EAASU,EAAE,eACNnB,EAAKxB,oBACPwB,EAAKxB,yBACXwB,EAAKoB,YAEFhB,EAAWe,EAAE,eACRnB,EAAKxB,kBAAkBM,GAAOkB,EAAKxB,uBACvC,SAAU6C,KAAM,mBACN,MAAOC,aAAc,MAAOC,YAAa,MAAOC,WAAY,UAGvEC,EAAmBzC,SAASO,eAAe,IAE3CuB,EAAeK,EAAE,aACZnB,EAAKxB,6BACPkD,QAAQ,IACdD,GAEGE,EAAWR,EAAE,OAASS,MAAU5B,EAAKxB,mBAAoBsC,GAEzDH,EAAUQ,EAAE,gBACPnB,EAAKxB,iBAAiBkB,KAAM,eAC9BmC,MAAO7B,EAAK8B,eAGfxB,EAAUa,EAAE,cACPnB,EAAKxB,eAAeuD,OAAQ/B,EAAK+B,YACrC,SAAUC,MAAQH,MAAO7B,EAAK6B,QAClCpB,EAAQL,EAAUuB,EAAUhB,KAKvBjC,iBAAoBsB,EAAKxB,gBAAgB,aACvCyD,cAMN1B,GAAkB,EAClBF,EAAe,YA8DX3B,iBAAiB,kBAAmB,SAASwD,IAEhD5B,EAAQ6B,eAEHC,oBAAoB,kBAAmBF,KAGrC5B,EAAYN,EAAKxB,iBAAiBwB,QAOtCtB,iBAAoBsB,EAAKxB,iBAAiB,WAInC8B,EAAQ+B,cAAcC,YAAYC,WAAWvC,EAAKuC,YAAc,sBAExEC,YAAYvC,KAKTvB,iBAAiB,QAASuB,KAE3BvB,iBAAiB,QAASuB,KAC1BvB,iBAAiB,SAAUwC,KAC3BxC,iBAAoBsB,EAAKxB,iBAAiBiE,YAG5CnC","preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi9Vc2Vycy9qb25hdGhhbm5lYWwvR2l0SHViL0VzcmkvZ2xvYmFsLW5hdi9zZWFyY2gvbm9kZV9tb2R1bGVzL2RvbW9zZS9kb21vc2UuanMiLCIvVXNlcnMvam9uYXRoYW5uZWFsL0dpdEh1Yi9Fc3JpL2dsb2JhbC1uYXYvc2VhcmNoL25vZGVfbW9kdWxlcy9lc3JpLWdsb2JhbC1zaGFyZWQvc2hhcmVkLmpzIiwiL1VzZXJzL2pvbmF0aGFubmVhbC9HaXRIdWIvRXNyaS9nbG9iYWwtbmF2L3NlYXJjaC9kZXBlbmRlbnQtanMvc2VhcmNoLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIFNwZWN1bGF0aXZlIERPTSBGdW5jdGlvbmFsaXR5XG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiBfX2Fzc2lnblNvdXJjZShlbGVtZW50LCBzb3VyY2UsIHByZWZpeCkge1xuXHRmb3IgKGxldCBrZXkgaW4gc291cmNlKSB7XG5cdFx0aWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBzb3VyY2Vba2V5XSkge1xuXHRcdFx0Ly8gYWRkIGZ1bmN0aW9ucyBhcyBldmVudCBsaXN0ZW5lcnNcblx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihwcmVmaXggKyBrZXksIHNvdXJjZVtrZXldKTtcblx0XHR9IGVsc2UgaWYgKE9iamVjdChzb3VyY2Vba2V5XSkgPT09IHNvdXJjZVtrZXldKSB7XG5cdFx0XHQvLyBhc3NpZ24gb2JqZWN0cyBhcyBzb3VyY2Vcblx0XHRcdF9fYXNzaWduU291cmNlKGVsZW1lbnQsIHNvdXJjZVtrZXldLCBgJHtwcmVmaXggKyBrZXl9LWApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBvdGhlcndpc2UsIHNldCBhdHRyaWJ1dGVzXG5cdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShwcmVmaXggKyBrZXksIHNvdXJjZVtrZXldKTtcblx0XHR9XG5cdH1cbn1cblxuLyogQXNzaWduIGFuIGVsZW1lbnQgd2l0aCBhdHRyaWJ1dGVzLCBldmVudHMsIGFuZCBjaGlsZHJlblxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJGFzc2lnbihpZCkge1xuXHQvLyAkYXNzaWduKGVsZW1lbnQsIHsgY2xhc3M6ICdidG4nLCBjbGljazogKCkgPT4geyAvKiBsaXN0ZW5lciAqLyB9IH0pO1xuXHQvLyAkYXNzaWduKCdidXR0b24nLCB7IGFyaWE6IHsgbGFiZWw6ICd0aXRsZScgfSB9LCBjaGlsZCk7XG5cdC8vICRhc3NpZ24oJ2RpdicsIGNoaWxkMSwgY2hpbGQyLCAnYSBuZXcgdGV4dCBub2RlJyk7XG5cdC8vICRhc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKSk7XG5cblx0Y29uc3QgZWxlbWVudCA9IGlkIGluc3RhbmNlb2YgTm9kZSA/IGlkIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpZCk7XG5cblx0W10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLmZvckVhY2goKHNvdXJjZSkgPT4ge1xuXHRcdGlmIChzb3VyY2UgaW5zdGFuY2VvZiBOb2RlKSB7XG5cdFx0XHQvLyBhcHBlbmQgc291cmNlcyB0aGF0IGFyZSBub2Rlc1xuXHRcdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChzb3VyY2UpO1xuXHRcdH0gZWxzZSBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBzb3VyY2UpIHtcblx0XHRcdC8vIGFwcGVuZCBzdHJpbmdzIGFzIHRleHQgbm9kZXNcblx0XHRcdGVsZW1lbnQuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHNvdXJjZSlcblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdF9fYXNzaWduU291cmNlKGVsZW1lbnQsIHNvdXJjZSwgJycpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGVsZW1lbnQ7XG59XG5cbi8qIFJlcGxhY2UgYWxsIHRoZSBjaGlsZHJlbiBvZiBhIHBhcmVudCBub2RlIHdpdGggbmV3IGNoaWxkcmVuXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkcmVwbGFjZUFsbChwYXJlbnROb2RlKSB7XG5cdC8vICRyZXBsYWNlQWxsKGVsZW1lbnQpO1xuXHQvLyAkcmVwbGFjZUFsbChlbGVtZW50LCBjaGlsZDEsIGNoaWxkMik7XG5cblx0d2hpbGUgKHBhcmVudE5vZGUubGFzdENoaWxkKSB7XG5cdFx0cGFyZW50Tm9kZS5yZW1vdmVDaGlsZChwYXJlbnROb2RlLmxhc3RDaGlsZCk7XG5cdH1cblxuXHRwYXJlbnROb2RlLmFwcGVuZENoaWxkKFxuXHRcdF9fYXNGcmFnbWVudChhcmd1bWVudHMpXG5cdCk7XG5cblx0cmV0dXJuIHBhcmVudE5vZGU7XG59XG5cbi8qIFdyYXAgYSBjaGlsZCBub2RlIHdpdGhpbiBhbiBlbGVtZW50XG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkd3JhcFdpdGgoY2hpbGROb2RlLCBlbGVtZW50KSB7XG5cdC8vICR3cmFwV2l0aChlbGVtZW50LCB3cmFwcGluZ0VsZW1lbnQpO1xuXG5cdGlmIChjaGlsZE5vZGUucGFyZW50Tm9kZSkge1xuXHRcdGNoaWxkTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlbGVtZW50LCBjaGlsZE5vZGUpLmFwcGVuZENoaWxkKGNoaWxkTm9kZSk7XG5cdH1cblxuXHRyZXR1cm4gY2hpbGROb2RlO1xufVxuXG4vKiBFbWVyZ2luZyBET00gRnVuY3Rpb25hbGl0eVxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gX19hc0ZyYWdtZW50KG5vZGVzKSB7XG5cdGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG5cdFtdLnNsaWNlLmNhbGwobm9kZXMsIDEpLmZvckVhY2goKG5vZGUpID0+IHtcblx0XHRpZiAobm9kZSBpbnN0YW5jZW9mIE5vZGUpIHtcblx0XHRcdGZyYWdtZW50LmFwcGVuZENoaWxkKG5vZGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRmcmFnbWVudC5hcHBlbmRDaGlsZChcblx0XHRcdFx0ZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobm9kZSlcblx0XHRcdCk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gZnJhZ21lbnQ7XG59XG5cbi8qIEluc2VydCBub2RlcyBhZnRlciBhIGNoaWxkIG5vZGVcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRhZnRlcihjaGlsZE5vZGUpIHtcblx0Ly8gJGFmdGVyKGVsZW1lbnQsIHNpYmxpbmcxLCBzaWJsaW5nMiwgJ2EgbmV3IHRleHQgbm9kZScpO1xuXG5cdGlmIChjaGlsZE5vZGUucGFyZW50Tm9kZSkge1xuXHRcdGNoaWxkTm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShcblx0XHRcdF9fYXNGcmFnbWVudChhcmd1bWVudHMpLFxuXHRcdFx0Y2hpbGROb2RlLm5leHRTaWJsaW5nXG5cdFx0KTtcblx0fVxuXG5cdHJldHVybiBjaGlsZE5vZGU7XG59XG5cbi8qIEFwcGVuZHMgbm9kZXMgdG8gYSBwYXJlbnQgbm9kZVxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJGFwcGVuZChwYXJlbnROb2RlKSB7XG5cdC8vICRhcHBlbmQocGFyZW50Tm9kZSwgY2hpbGQxLCBjaGlsZDIsICdhIG5ldyB0ZXh0IG5vZGUnKTtcblxuXHRwYXJlbnROb2RlLmFwcGVuZChcblx0XHRfX2FzRnJhZ21lbnQoYXJndW1lbnRzKVxuXHQpO1xuXG5cdHJldHVybiBwYXJlbnROb2RlO1xufVxuXG4vKiBJbnNlcnQgbm9kZXMgYmVmb3JlIGFuIGVsZW1lbnRcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRiZWZvcmUoZWxlbWVudCkge1xuXHQvLyAkYmVmb3JlKGVsZW1lbnQsIHNpYmxpbmcxLCBzaWJsaW5nMiwgJ2EgbmV3IHRleHQgbm9kZScpO1xuXG5cdGlmIChlbGVtZW50LnBhcmVudE5vZGUpIHtcblx0XHRlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKFxuXHRcdFx0X19hc0ZyYWdtZW50KGFyZ3VtZW50cyksXG5cdFx0XHRlbGVtZW50XG5cdFx0KTtcblx0fVxuXG5cdHJldHVybiBlbGVtZW50O1xufVxuXG4vKiBSZXR1cm4gdGhlIGNsb3Nlc3QgYW5jZXN0b3IgZWxlbWVudCBtYXRjaGluZyBhIGdpdmVuIHNlbGVjdG9yXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkY2xvc2VzdChlbGVtZW50LCBzZWxlY3RvcnMpIHtcblx0Ly8gJGNsb3Nlc3QoZWxlbWVudCwgc2VsZWN0b3JzKTtcblxuXHRsZXQgdGFyZ2V0ID0gZWxlbWVudDtcblxuXHR3aGlsZSAodGFyZ2V0ICYmIDEgPT09IHRhcmdldC5ub2RlVHlwZSkge1xuXHRcdGlmICgkbWF0Y2hlcyh0YXJnZXQsIHNlbGVjdG9ycykpIHtcblx0XHRcdHJldHVybiB0YXJnZXQ7XG5cdFx0fVxuXG5cdFx0dGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7XG5cdH1cblxuXHRyZXR1cm4gbnVsbDtcbn1cblxuLyogUmV0dXJuIHdoZXRoZXIgb3Igbm90IGEgRE9NIGVsZW1lbnQgbWF0Y2hlcyBhIGdpdmVuIHNlbGVjdG9yXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5mdW5jdGlvbiAkbWF0Y2hlcyhlbGVtZW50LCBzZWxlY3RvcnMpIHtcblx0Ly8gJG1hdGNoZXMoZWxlbWVudCwgc2VsZWN0b3JzKTtcblxuXHRjb25zdCBlbGVtZW50cyA9IGVsZW1lbnQucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9ycyk7XG5cblx0bGV0IGluZGV4ID0gMDtcblxuXHR3aGlsZSAoZWxlbWVudHNbaW5kZXhdICYmIGVsZW1lbnRzW2luZGV4XSAhPT0gZWxlbWVudCkge1xuXHRcdCsraW5kZXg7XG5cdH1cblxuXHRyZXR1cm4gQm9vbGVhbihlbGVtZW50c1tpbmRleF0pO1xufVxuXG4vKiBQcmVwZW5kcyBhIGNoaWxkIHRvIGEgcGFyZW50IG5vZGVcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRwcmVwZW5kKHBhcmVudE5vZGUpIHtcblx0Ly8gJHByZXBlbmQoZWxlbWVudCwgY2hpbGQxLCBjaGlsZDIsICdhIG5ldyB0ZXh0IG5vZGUnKTtcblxuXHRwYXJlbnROb2RlLmluc2VydEJlZm9yZShcblx0XHRfX2FzRnJhZ21lbnQoYXJndW1lbnRzKSxcblx0XHRwYXJlbnROb2RlLmZpcnN0Q2hpbGRcblx0KTtcblxuXHRyZXR1cm4gcGFyZW50Tm9kZTtcbn1cblxuLyogUmVtb3ZlIGEgY2hpbGQgbm9kZSBmcm9tIGl0cyBwYXJlbnRcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRyZW1vdmUoY2hpbGROb2RlKSB7XG5cdC8vICRyZW1vdmUoZWxlbWVudCk7XG5cblx0aWYgKGNoaWxkTm9kZS5wYXJlbnROb2RlKSB7XG5cdFx0Y2hpbGROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY2hpbGROb2RlKTtcblx0fVxuXG5cdHJldHVybiBjaGlsZE5vZGU7XG59XG5cbi8qIFJlcGxhY2UgYSBjaGlsZCBub2RlIHdpdGggbm9kZXNcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRyZXBsYWNlV2l0aChjaGlsZE5vZGUpIHtcblx0Ly8gJHJlcGxhY2VXaXRoKGVsZW1lbnQsIHNpYmxpbmcxLCBzaWJsaW5nMiwgJ2EgbmV3IHRleHQgbm9kZScpO1xuXG5cdGlmIChjaGlsZE5vZGUucGFyZW50Tm9kZSkge1xuXHRcdGNoaWxkTm9kZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChcblx0XHRcdF9fYXNGcmFnbWVudChhcmd1bWVudHMpLFxuXHRcdFx0Y2hpbGROb2RlXG5cdFx0KTtcblx0fVxuXG5cdHJldHVybiBjaGlsZE5vZGU7XG59XG5cbi8qIEVtZXJnaW5nIEV2ZW50IEZ1bmN0aW9uYWxpdHlcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbi8qIENyZWF0ZSBhIG5ldyBDdXN0b21FdmVudFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJEN1c3RvbUV2ZW50KHR5cGUpIHtcblx0Ly8gZWxlbWVudC5kaXNwYXRjaEV2ZW50KG5ldyAkQ3VzdG9tRXZlbnQoJ2NsaWNrJywgeyBidWJibGVzOiB0cnVlIH0pKTtcblxuXHRjb25zdCBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuXHRjb25zdCBwYXJhbSA9IE9iamVjdChhcmd1bWVudHNbMV0pIHx8IHsgYnViYmxlczogZmFsc2UsIGNhbmNlbGFibGU6IGZhbHNlLCBkZXRhaWw6IHVuZGVmaW5lZCB9O1xuXG5cdGV2ZW50LmluaXRDdXN0b21FdmVudCh0eXBlLCBwYXJhbS5idWJibGVzLCBwYXJhbS5jYW5jZWxhYmxlLCBwYXJhbS5kZXRhaWwpO1xuXG5cdHJldHVybiBldmVudDtcbn1cblxuLyogRmV0Y2ggcmVzcG9uc2UgdGV4dCBmcm9tIGEgVVJMIGFuZCBwYXNzIGl0IHRvIGEgY2FsbGJhY2tcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmZ1bmN0aW9uICRmZXRjaCh1cmwsIGNhbGxiYWNrKSB7XG5cdC8vICRmZXRjaCgnYXBpP2Zvbz1iYXInLCAocmVzcG9uc2VUZXh0KSA9PiB7fSk7XG5cblx0Y29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cblx0eGhyLmFkZEV2ZW50TGlzdGVuZXIoJ3JlYWR5c3RhdGVjaGFuZ2UnLCAoKSA9PiB7XG5cdFx0aWYgKDQgPT09IHhoci5yZWFkeVN0YXRlICYmIDIwMCA9PT0geGhyLnN0YXR1cykge1xuXHRcdFx0Y2FsbGJhY2soeGhyLnJlc3BvbnNlVGV4dCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY2FsbGJhY2stcmV0dXJuXG5cdFx0fVxuXHR9KTtcblxuXHR4aHIub3BlbignR0VUJywgdXJsKTtcblx0eGhyLnNlbmQoKTtcblxuXHRyZXR1cm4geGhyO1xufVxuXG4vKiBFeHBvcnRcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cbmV4cG9ydCB7XG5cdCRhc3NpZ24sXG5cdCRhZnRlcixcblx0JGFwcGVuZCxcblx0JGJlZm9yZSxcblx0JGNsb3Nlc3QsXG5cdCRDdXN0b21FdmVudCxcblx0JGZldGNoLFxuXHQkbWF0Y2hlcyxcblx0JHByZXBlbmQsXG5cdCRyZW1vdmUsXG5cdCRyZXBsYWNlQWxsLFxuXHQkcmVwbGFjZVdpdGgsXG5cdCR3cmFwV2l0aFxufTtcbiIsImltcG9ydCB7ICRhc3NpZ24sICRmZXRjaCwgJHJlcGxhY2VBbGwgfSBmcm9tICdkb21vc2UnO1xuXG4vKiBEaXNwYXRjaCBhbiBDdXN0b20gRXZlbnQgd2l0aCBhIGRldGFpbFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZnVuY3Rpb24gJGRpc3BhdGNoKHRhcmdldCwgdHlwZSwgZGV0YWlsKSB7XG5cdC8vIGFuIGV2ZW50XG5cdGNvbnN0IGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG5cblx0ZXZlbnQuaW5pdEN1c3RvbUV2ZW50KHR5cGUsIHRydWUsIHRydWUsIGRldGFpbCk7XG5cblx0dGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG5mdW5jdGlvbiAkZW5hYmxlRm9jdXNSaW5nKHRhcmdldCkge1xuXHQvLyByZXRvb2xlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9qb25hdGhhbnRuZWFsL2pzLWZvY3VzLXJpbmdcblxuXHRsZXQga2V5Ym9hcmRUaHJvdHRsZVRpbWVvdXRJRDtcblxuXHRjb25zdCBhY3RpdmVFbGVtZW50cyA9IFtdO1xuXG5cdHRhcmdldC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKCkgPT4ge1xuXHRcdGFjdGl2ZUVsZW1lbnRzLmZvckVhY2goKGFjdGl2ZUVsZW1lbnQpID0+IHtcblx0XHRcdGFjdGl2ZUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdqcy1mb2N1cycpO1xuXHRcdFx0YWN0aXZlRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2pzLWZvY3VzLXJpbmcnKTtcblx0XHR9KTtcblx0fSwgdHJ1ZSk7XG5cblx0dGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgKCkgPT4ge1xuXHRcdGNvbnN0IGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXG5cdFx0aWYgKGFjdGl2ZUVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG5cdFx0XHRhY3RpdmVFbGVtZW50LnNldEF0dHJpYnV0ZSgnanMtZm9jdXMnLCAnJyk7XG5cblx0XHRcdGlmIChrZXlib2FyZFRocm90dGxlVGltZW91dElEKSB7XG5cdFx0XHRcdGFjdGl2ZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdqcy1mb2N1cy1yaW5nJywgJycpO1xuXHRcdFx0fVxuXG5cdFx0XHRhY3RpdmVFbGVtZW50cy5wdXNoKGFjdGl2ZUVsZW1lbnQpO1xuXHRcdH1cblx0fSwgdHJ1ZSk7XG5cblx0dGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoKSA9PiB7XG5cdFx0a2V5Ym9hcmRUaHJvdHRsZVRpbWVvdXRJRCA9IGNsZWFyVGltZW91dChrZXlib2FyZFRocm90dGxlVGltZW91dElEKSB8fCBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGtleWJvYXJkVGhyb3R0bGVUaW1lb3V0SUQgPSAwO1xuXHRcdH0sIDEwMCk7XG5cdH0sIHRydWUpO1xufVxuXG5leHBvcnQge1xuXHQkYXNzaWduLFxuXHQkZGlzcGF0Y2gsXG5cdCRlbmFibGVGb2N1c1JpbmcsXG5cdCRmZXRjaCxcblx0JHJlcGxhY2VBbGxcbn07XG4iLCJpbXBvcnQgeyAkYXNzaWduIGFzICQsICRkaXNwYXRjaCB9IGZyb20gJ2VzcmktZ2xvYmFsLXNoYXJlZCc7XG5cbi8qIFNlYXJjaFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuZXhwb3J0IGRlZmF1bHQgKGRhdGEpID0+IHtcblx0LyogRWxlbWVudHNcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdGNvbnN0ICRsYWJlbCA9ICQoJ2xhYmVsJywge1xuXHRcdGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tbGFiZWxgLFxuXHRcdGZvcjogYCR7ZGF0YS5wcmVmaXh9LXF1ZXJ5LWNvbnRyb2xgXG5cdH0sIGRhdGEucXVlcnlMYWJlbCk7XG5cblx0Y29uc3QgJGNvbnRyb2wgPSAkKCdpbnB1dCcsIHtcblx0XHRjbGFzczogYCR7ZGF0YS5wcmVmaXh9LWNvbnRyb2xgLCBpZDogYCR7ZGF0YS5wcmVmaXh9LWNvbnRyb2xgLFxuXHRcdHR5cGU6ICdzZWFyY2gnLCBuYW1lOiAncScsXG5cdFx0YXV0b2NhcGl0YWxpemU6ICdvZmYnLCBhdXRvY29tcGxldGU6ICdvZmYnLCBhdXRvY29ycmVjdDogJ29mZicsIHNwZWxsY2hlY2s6ICdmYWxzZSdcblx0fSk7XG5cblx0Y29uc3QgJG1lYXN1cmVUZXh0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcblxuXHRjb25zdCAkbWVhc3VyZVRleHQgPSAkKCdkaXYnLCB7XG5cdFx0Y2xhc3M6IGAke2RhdGEucHJlZml4fS1tZWFzdXJlLXRleHRgLFxuXHRcdGFyaWE6IHsgaGlkZGVuOiB0cnVlIH1cblx0fSwgJG1lYXN1cmVUZXh0Tm9kZSk7XG5cblx0Y29uc3QgJG1lYXN1cmUgPSAkKCdkaXYnLCB7IGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tbWVhc3VyZWAgfSwgJG1lYXN1cmVUZXh0KTtcblxuXHRjb25zdCAkc3VibWl0ID0gJCgnYnV0dG9uJywge1xuXHRcdGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tc3VibWl0YCwgdHlwZTogJ3N1Ym1pdCcsXG5cdFx0YXJpYTogeyBsYWJlbDogZGF0YS5zdWJtaXRMYWJlbCB9XG5cdH0pO1xuXG5cdGNvbnN0ICRzZWFyY2ggPSAkKCdmb3JtJywge1xuXHRcdGNsYXNzOiBgJHtkYXRhLnByZWZpeH0tZm9ybWAsIGFjdGlvbjogZGF0YS5hY3Rpb24sXG5cdFx0cm9sZTogJ3NlYXJjaCcsIGFyaWE6IHsgbGFiZWw6IGRhdGEubGFiZWwgfVxuXHR9LCAkbGFiZWwsICRjb250cm9sLCAkbWVhc3VyZSwgJHN1Ym1pdCk7XG5cblx0LyogRm9jdXMgRXZlbnRcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdCRzZWFyY2guYWRkRXZlbnRMaXN0ZW5lcihgJHtkYXRhLnByZWZpeH06Zm9jdXNgLCAoKSA9PiB7XG5cdFx0JGNvbnRyb2wuZm9jdXMoKTtcblx0fSk7XG5cblx0LyogT24gSW5wdXRcblx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdGxldCBjb250cm9sSXNGaWxsZWQgPSBmYWxzZTtcblx0bGV0IGNvbnRyb2xWYWx1ZSA9ICcnO1xuXG5cdGZ1bmN0aW9uIG9uaW5wdXQoZXZlbnQpIHtcblx0XHQvKiBDb25kaXRpb25hbGx5IFJlc2V0IENvbnRyb2wgVmFsdWVcblx0XHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRcdGlmIChldmVudCAmJiAncmVzZXQnID09PSBldmVudC50eXBlKSB7XG5cdFx0XHQkY29udHJvbC52YWx1ZSA9ICcnO1xuXHRcdH1cblxuXHRcdC8qIFVwZGF0ZSBOZXcgQ29udHJvbCBWYWx1ZVxuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuXG5cdFx0Y29uc3QgbmV3Q29udHJvbFZhbHVlID0gJGNvbnRyb2wudmFsdWU7XG5cblx0XHRpZiAobmV3Q29udHJvbFZhbHVlICE9PSBjb250cm9sVmFsdWUpIHtcblx0XHRcdGNvbnRyb2xWYWx1ZSA9IG5ld0NvbnRyb2xWYWx1ZTtcblxuXHRcdFx0JGRpc3BhdGNoKCRzZWFyY2gsIGAke2RhdGEucHJlZml4fTppbnB1dGAsIHtcblx0XHRcdFx0dmFsdWU6IGNvbnRyb2xWYWx1ZSxcblx0XHRcdFx0ZXZlbnRcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qIFVwZGF0ZSBMYWJlbCBhbmQgU3VibWl0IFVJXG5cdFx0LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0XHRpZiAoY29udHJvbElzRmlsbGVkICYmICFuZXdDb250cm9sVmFsdWUpIHtcblx0XHRcdGNvbnRyb2xJc0ZpbGxlZCA9IGZhbHNlO1xuXG5cdFx0XHQkbGFiZWwucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWZpbGxlZCcpO1xuXHRcdFx0JHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZmlsbGVkJyk7XG5cdFx0fSBlbHNlIGlmICghY29udHJvbElzRmlsbGVkICYmIG5ld0NvbnRyb2xWYWx1ZSkge1xuXHRcdFx0Y29udHJvbElzRmlsbGVkID0gdHJ1ZTtcblxuXHRcdFx0JCgkbGFiZWwsIHsgZGF0YTogeyBmaWxsZWQ6ICcnIH0gfSk7XG5cdFx0XHQkKCRzdWJtaXQsIHsgZGF0YTogeyBmaWxsZWQ6ICcnIH0gfSk7XG5cdFx0fVxuXG5cdFx0LyogVXBkYXRlIE1lYXN1cmUgVUlcblx0XHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRcdCRtZWFzdXJlVGV4dE5vZGUubm9kZVZhbHVlID0gbmV3Q29udHJvbFZhbHVlO1xuXG5cdFx0Y29uc3QgY3VycmVudFdpZHRoID0gYCR7JG1lYXN1cmVUZXh0LnNjcm9sbFdpZHRofXB4YDtcblxuXHRcdCRtZWFzdXJlLnN0eWxlLndpZHRoID0gY3VycmVudFdpZHRoO1xuXHR9XG5cblx0LyogT24gU3VibWl0XG5cdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRmdW5jdGlvbiBvbnN1Ym1pdChldmVudCkge1xuXHRcdCRkaXNwYXRjaCgkc2VhcmNoLCBgJHtkYXRhLnByZWZpeH06c3VibWl0YCwge1xuXHRcdFx0dmFsdWU6ICRjb250cm9sLnZhbHVlLFxuXHRcdFx0ZXZlbnRcblx0XHR9KTtcblx0fVxuXG5cdC8qIE9uIERPTU5vZGVJbnNlcnRlZFxuXHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0JHNlYXJjaC5hZGRFdmVudExpc3RlbmVyKCdET01Ob2RlSW5zZXJ0ZWQnLCBmdW5jdGlvbiBvbkRPTU5vZGVJbnNlcnRlZCgpIHtcblx0XHQvLyBJZiBTZWFyY2ggbm93IGhhcyBhIHBhcmVudCBub2RlXG5cdFx0aWYgKCRzZWFyY2gucGFyZW50Tm9kZSkge1xuXHRcdFx0Ly8gVW5iaW5kIHRoZSBET01Ob2RlSW5zZXJ0ZWQgbWV0aG9kXG5cdFx0XHQkc2VhcmNoLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ0RPTU5vZGVJbnNlcnRlZCcsIG9uRE9NTm9kZUluc2VydGVkKTtcblxuXHRcdFx0Ly8gVXBkYXRlIFNlYXJjaFxuXHRcdFx0JGRpc3BhdGNoKCRzZWFyY2gsIGAke2RhdGEucHJlZml4fTp1cGRhdGVgLCBkYXRhKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8qIE9uIFVwZGF0ZVxuXHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG5cblx0JHNlYXJjaC5hZGRFdmVudExpc3RlbmVyKGAke2RhdGEucHJlZml4fTp1cGRhdGVgLCAoKSA9PiB7XG5cdFx0LyogQmluZCBNZWRpYSBFdmVudFxuXHRcdC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRcdGNvbnN0IG1lZGlhID0gJHNlYXJjaC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3Lm1hdGNoTWVkaWEoZGF0YS5tYXRjaE1lZGlhIHx8ICcobWF4LXdpZHRoOiA3MjBweCknKTtcblxuXHRcdG1lZGlhLmFkZExpc3RlbmVyKG9uaW5wdXQpO1xuXG5cdFx0LyogQmluZCBPdGhlciBFdmVudHNcblx0XHQvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cblxuXHRcdCRjb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25pbnB1dCk7XG5cblx0XHQkc2VhcmNoLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0Jywgb25pbnB1dCk7XG5cdFx0JHNlYXJjaC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBvbnN1Ym1pdCk7XG5cdFx0JHNlYXJjaC5hZGRFdmVudExpc3RlbmVyKGAke2RhdGEucHJlZml4fTp1bmxvYWRgLCBvbnVubG9hZCk7XG5cdH0pO1xuXG5cdHJldHVybiAkc2VhcmNoO1xufTtcbiJdLCJuYW1lcyI6WyJfX2Fzc2lnblNvdXJjZSIsImVsZW1lbnQiLCJzb3VyY2UiLCJwcmVmaXgiLCJrZXkiLCJhZGRFdmVudExpc3RlbmVyIiwiT2JqZWN0Iiwic2V0QXR0cmlidXRlIiwiJGFzc2lnbiIsImlkIiwiTm9kZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNsaWNlIiwiY2FsbCIsImFyZ3VtZW50cyIsImZvckVhY2giLCJhcHBlbmRDaGlsZCIsImNyZWF0ZVRleHROb2RlIiwiJGRpc3BhdGNoIiwidGFyZ2V0IiwidHlwZSIsImRldGFpbCIsImV2ZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJkaXNwYXRjaEV2ZW50IiwiZGF0YSIsIm9uaW5wdXQiLCJ2YWx1ZSIsIm5ld0NvbnRyb2xWYWx1ZSIsIiRjb250cm9sIiwiY29udHJvbFZhbHVlIiwiJHNlYXJjaCIsImNvbnRyb2xJc0ZpbGxlZCIsInJlbW92ZUF0dHJpYnV0ZSIsIiRsYWJlbCIsImZpbGxlZCIsIiRzdWJtaXQiLCJub2RlVmFsdWUiLCJjdXJyZW50V2lkdGgiLCIkbWVhc3VyZVRleHQiLCJzY3JvbGxXaWR0aCIsInN0eWxlIiwid2lkdGgiLCJvbnN1Ym1pdCIsIiQiLCJxdWVyeUxhYmVsIiwibmFtZSIsImF1dG9jb21wbGV0ZSIsImF1dG9jb3JyZWN0Iiwic3BlbGxjaGVjayIsIiRtZWFzdXJlVGV4dE5vZGUiLCJoaWRkZW4iLCIkbWVhc3VyZSIsImNsYXNzIiwibGFiZWwiLCJzdWJtaXRMYWJlbCIsImFjdGlvbiIsImFyaWEiLCJmb2N1cyIsIm9uRE9NTm9kZUluc2VydGVkIiwicGFyZW50Tm9kZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvd25lckRvY3VtZW50IiwiZGVmYXVsdFZpZXciLCJtYXRjaE1lZGlhIiwiYWRkTGlzdGVuZXIiLCJvbnVubG9hZCJdLCJtYXBwaW5ncyI6InVDQUdBLFNBQVNBLEVBQWVDLEVBQVNDLEVBQVFDLE9BQ25DLElBQUlDLEtBQU9GLEVBQ1gsbUJBQXNCQSxFQUFPRSxLQUV4QkMsaUJBQWlCRixFQUFTQyxFQUFLRixFQUFPRSxJQUNwQ0UsT0FBT0osRUFBT0UsTUFBVUYsRUFBT0UsS0FFMUJILEVBQVNDLEVBQU9FLEdBQVNELEVBQVNDLFNBR3pDRyxhQUFhSixFQUFTQyxFQUFLRixFQUFPRSxJQVE3QyxTQUFTSSxFQUFRQyxPQU1WUixFQUFVUSxhQUFjQyxLQUFPRCxFQUFLRSxTQUFTQyxjQUFjSCxZQUU5REksTUFBTUMsS0FBS0MsVUFBVyxHQUFHQyxRQUFRLFNBQUNkLEdBQ2hDQSxhQUFrQlEsT0FFYk8sWUFBWWYsR0FDVixpQkFBb0JBLElBRXRCZSxZQUNQTixTQUFTTyxlQUFlaEIsTUFHVkQsRUFBU0MsRUFBUSxNQUkzQkQsRUN0Q1IsU0FBU2tCLEVBQVVDLEVBQVFDLEVBQU1DLE9BRTFCQyxFQUFRWixTQUFTYSxZQUFZLGlCQUU3QkMsZ0JBQWdCSixHQUFNLEdBQU0sRUFBTUMsS0FFakNJLGNBQWNILG1CQ05OSSxZQStDTkMsRUFBUUwsR0FJWkEsR0FBUyxVQUFZQSxFQUFNRixTQUNyQlEsTUFBUSxRQU1aQyxFQUFrQkMsRUFBU0YsTUFFN0JDLElBQW9CRSxNQUNSRixJQUVMRyxFQUFZTixFQUFLeEIsdUJBQ25CNkIsYUFRTEUsSUFBb0JKLE1BQ0wsSUFFWEssZ0JBQWdCLGlCQUNmQSxnQkFBZ0IsaUJBQ2JELEdBQW1CSixPQUNaLElBRWhCTSxHQUFVVCxNQUFRVSxPQUFRLFFBQzFCQyxHQUFXWCxNQUFRVSxPQUFRLFNBTWJFLFVBQVlULE1BRXZCVSxFQUFrQkMsRUFBYUMsbUJBRTVCQyxNQUFNQyxNQUFRSixXQU1mSyxFQUFTdEIsS0FDUFUsRUFBWU4sRUFBS3hCLHdCQUNuQjRCLEVBQVNGLG9CQS9GWk8sRUFBU1UsRUFBRSxlQUNObkIsRUFBS3hCLG9CQUNQd0IsRUFBS3hCLHlCQUNYd0IsRUFBS29CLFlBRUZoQixFQUFXZSxFQUFFLGVBQ1JuQixFQUFLeEIsa0JBQWtCTSxHQUFPa0IsRUFBS3hCLHVCQUN2QyxTQUFVNkMsS0FBTSxtQkFDTixNQUFPQyxhQUFjLE1BQU9DLFlBQWEsTUFBT0MsV0FBWSxVQUd2RUMsRUFBbUJ6QyxTQUFTTyxlQUFlLElBRTNDdUIsRUFBZUssRUFBRSxhQUNabkIsRUFBS3hCLDZCQUNQa0QsUUFBUSxJQUNkRCxHQUVHRSxFQUFXUixFQUFFLE9BQVNTLE1BQVU1QixFQUFLeEIsbUJBQW9Cc0MsR0FFekRILEVBQVVRLEVBQUUsZ0JBQ1BuQixFQUFLeEIsaUJBQWlCa0IsS0FBTSxlQUM5Qm1DLE1BQU83QixFQUFLOEIsZUFHZnhCLEVBQVVhLEVBQUUsY0FDUG5CLEVBQUt4QixlQUFldUQsT0FBUS9CLEVBQUsrQixZQUNyQyxTQUFVQyxNQUFRSCxNQUFPN0IsRUFBSzZCLFFBQ2xDcEIsRUFBUUwsRUFBVXVCLEVBQVVoQixLQUt2QmpDLGlCQUFvQnNCLEVBQUt4QixnQkFBZ0IsYUFDdkN5RCxjQU1OMUIsR0FBa0IsRUFDbEJGLEVBQWUsWUE4RFgzQixpQkFBaUIsa0JBQW1CLFNBQVN3RCxJQUVoRDVCLEVBQVE2QixlQUVIQyxvQkFBb0Isa0JBQW1CRixLQUdyQzVCLEVBQVlOLEVBQUt4QixpQkFBaUJ3QixRQU90Q3RCLGlCQUFvQnNCLEVBQUt4QixpQkFBaUIsV0FJbkM4QixFQUFRK0IsY0FBY0MsWUFBWUMsV0FBV3ZDLEVBQUt1QyxZQUFjLHNCQUV4RUMsWUFBWXZDLEtBS1R2QixpQkFBaUIsUUFBU3VCLEtBRTNCdkIsaUJBQWlCLFFBQVN1QixLQUMxQnZCLGlCQUFpQixTQUFVd0MsS0FDM0J4QyxpQkFBb0JzQixFQUFLeEIsaUJBQWlCaUUsWUFHNUNuQyJ9"}